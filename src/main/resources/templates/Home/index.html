<!DOCTYPE html>
<html lang="vi" xmlns:th="">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Ogani Template">
    <meta name="keywords" content="Ogani, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ogani | Template</title>
    <th:block th:replace="layout :: link-css"></th:block>
</head>
<th:block th:replace="layout :: header"></th:block>
<body>
<!-- Hero Section Begin -->
<section class="hero">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="hero__categories">
                    <div class="hero__categories__all">
                        <i class="fas fa-bars"></i>
                        <span>Danh mục</span>
                    </div>
                    <ul id="categoryList">
                        <!-- Danh sách thể loại sẽ được cập nhật từ API -->
                    </ul>
                </div>
            </div>
            <div class="col-lg-9">
                <div class="hero__search">
                    <div class="hero__search__form">
                        <form action="/search" th:method="GET">
                            <div class="hero__search__categories">
                                Danh mục
                                <span class="arrow_carrot-down"></span>
                            </div>
                            <input type="text" placeholder="Bạn cần tìm kiếm gì ?">
                            <button type="submit" class="site-btn">Tìm kiếm</button>
                        </form>
                    </div>
                    <div class="hero__search__phone">
                        <div class="hero__search__phone__icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="hero__search__phone__text">
                            <h5>+65 11.188.888</h5>
                            <span>support 24/7 time</span>
                        </div>
                    </div>
                </div>
                <div class="hero__item set-bg" data-setbg="img/banner/banner-hero.jpg">
                    <div class="hero__text">
                        <span>Hải sản tươi sống</span>
                        <h2>Chất lượng <br />100% độ uy tín</h2>
                        <p>Còn ngại gì mà không mua sắm ngay nào</p>
                        <a href="#" class="primary-btn">Mua ngay</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Hero Section End -->

<!-- Categories Section Begin -->
<section class="categories">
    <div class="container">
        <div class="row">
            <div class="categories__slider" id="categorySlider">
                <!-- Danh sách thể loại sẽ được cập nhật từ API -->
            </div>
        </div>
    </div>
</section>
<!-- Categories Section End -->

<!-- Featured Section Begin -->
<div class="featured spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="section-title">
                    <h2>Mặt hàng mới</h2>
                </div>
                <div class="featured__controls">
                    <ul>
                        <li class="active" data-filter="*">Tất cả</li>
                        <li data-filter="1">Cá</li>
                        <li data-filter="2">Mực</li>
                        <li data-filter="3">Tôm</li>
                        <li data-filter="4">Cua/Ghẹ</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row featured__filter" id="seafoodList">
<!--            gọi api hiển thị seafoods-->
        </div>
    </div>

</div>
<!-- Featured Section End -->
<!-- Banner Begin -->
<div class="banner">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-6">
                <div class="banner__pic">
                    <img src="/img/banner/banner-1.jpg" alt="">
                </div>
            </div>
            <div class="col-lg-6 col-md-6 col-sm-6">
                <div class="banner__pic">
                    <img src="/img/banner/banner-2.png" alt="">
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Banner End -->
<!-- Js Plugins -->
<th:block th:replace="layout :: footer"></th:block>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const seafoodList = document.getElementById('seafoodList');
        const filterItems = document.querySelectorAll('.featured__controls li');
        const maxProducts = 8;

        // Hàm hiển thị sản phẩm
        function displaySeafood(seafood) {
            const column = document.createElement('div');
            column.className = 'col-lg-3 col-md-4 col-sm-6 mix';
            column.innerHTML = `
            <div class="featured__item" data-category="${seafood.category.id}">
                <div class="featured__item__pic">
                    <img src="${seafood.mainImage}" alt="Seafood Image">
                    <ul class="featured__item__pic__hover">
                        <li><a href="#"><i class="fas fa-heart"></i></a></li>
                        <li><a href="#"><i class="fas fa-shopping-cart"></i></a></li>
                    </ul>
                </div>
                <div class="featured__item__text">
                    <h6><a href="${seafood.id}" title="${seafood.name}">${seafood.name}</a></h6>
                    <h5>${seafood.price.toLocaleString('vi-VN')} ₫</h5>
                </div>
            </div>`;
            seafoodList.appendChild(column);
        }

        // Hàm lọc sản phẩm theo category
        function filterSeafood(categoryId) {
            fetch('api/seafoods')
                .then(response => response.json())
                .then(data => {
                    let products = data.content;
                    if (categoryId !== '*') {
                        products = products.filter(seafood => seafood.category.id.toString() === categoryId);
                    }
                    seafoodList.innerHTML = ''; // Xóa danh sách hiện tại
                    products.slice(0, maxProducts).forEach(seafood => displaySeafood(seafood));
                })
                .catch(error => console.error('Error:', error));
        }

        // Gắn sự kiện click cho các thẻ li
        filterItems.forEach(item => {
            item.addEventListener('click', function () {
                filterItems.forEach(li => li.classList.remove('active')); // Xóa class 'active' hiện tại
                item.classList.add('active'); // Thêm class 'active' cho item được click
                const categoryId = item.getAttribute('data-filter'); // Lấy giá trị data-filter
                filterSeafood(categoryId); // Lọc và hiển thị sản phẩm theo category
            });
        });

        // Gọi hàm lọc khi trang được tải lần đầu
        filterSeafood('*');
    });
</script>
<script>
    // Sử dụng fetch để gọi API và cập nhật danh sách thể loại
    fetch('api/categories')
        .then(response => response.json())
        .then(data => {
            const categoryList = document.getElementById('categoryList');

            // Xóa mọi thẻ li hiện tại trong danh sách thể loại
            categoryList.innerHTML = '';

            // Duyệt qua dữ liệu từ API và thêm các thẻ li mới
            data.forEach(category => {
                const li = document.createElement('li');
                const a = document.createElement('a');

                // Sử dụng category.id hoặc một trường nào đó từ API để đặt giá trị href
                a.href = `#${category.id}`;
                a.textContent = category.name;

                li.appendChild(a);
                categoryList.appendChild(li);
            });
        })
        .catch(error => console.error('Lỗi khi gọi API:', error));
</script>
<script>
    $(document).ready(function () {
        // Sử dụng fetch để gọi API và cập nhật danh sách thể loại
        fetch('api/categories')
            .then(response => response.json())
            .then(data => {
                const categorySlider = $('#categorySlider');

                // Xóa mọi phần tử hiện tại trong danh sách thể loại
                categorySlider.empty();

                // Duyệt qua dữ liệu từ API và thêm các phần tử mới
                data.forEach(category => {
                    const item = $('<div class="categories__item">' +
                        `<img src="${category.img}" alt="${category.name}">` +
                        `<h5><a href="${category.id}">${category.name}</a></h5>` +
                        '</div>');

                    categorySlider.append(item);
                });
            })
            .catch(error => console.error('Lỗi khi gọi API:', error));
    });
</script>
</body>
</html>

