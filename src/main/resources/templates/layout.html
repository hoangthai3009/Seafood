<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Ogani Template">
    <meta name="keywords" content="Ogani, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hải Sản - Website</title>
</head>
<header>
    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-...." crossorigin="anonymous" />

    <!-- Css Styles -->
    <link th:fragment="link-css" rel="stylesheet" th:href="@{/css/css-seafood/bootstrap.min.css}" type="text/css">
    <link th:fragment="link-css" rel="stylesheet" th:href="@{/css/css-seafood/nice-select.css}" type="text/css">
    <link th:fragment="link-css" rel="stylesheet" th:href="@{/css/css-seafood/jquery-ui.min.css}" type="text/css">
    <link th:fragment="link-css" rel="stylesheet" th:href="@{/css/css-seafood/slicknav.min.css}" type="text/css">
    <link th:fragment="link-css" rel="stylesheet" th:href="@{/css/css-seafood/style.css}" type="text/css">
</header>
<body>
<!-- Page Preloder -->
<div id="preloder">
    <div class="loader"></div>
</div>

<header class="header">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <div class="header__logo">
                    <a href="/"><img src="" alt=""></a>
                </div>
            </div>
            <div class="col-lg-6">
                <nav class="header__menu">
                    <ul>
                        <li class="active"><a href="/">Trang chủ</a></li>
                        <li><a href="/seafood/list">Sản phẩm</a></li>
                        <li><a href="#">Pages</a>
                            <ul class="header__menu__dropdown">
                                <li><a href="./">Khuyến mãi</a></li>
                                <li><a href="./">Shoping Cart</a></li>
                                <li><a href="/cart/checkout">Check Out</a></li>
                                <li><a href="./">Blog Details</a></li>
                            </ul>
                        </li>
                        <li><a href="./blog.html">Khuyến mãi</a></li>
                    </ul>
                </nav>
            </div>
            <div class="col-lg-3">
                <div class="header__cart">
                    <ul>
                        <li><a href="#"><i class="fas fa-heart"></i> <span>1</span></a></li>
                        <li><a href="/cart"><i class="fas fa-shopping-bag"></i> <span id="cartItemCount"></span></a></li>
                        <div class="header__cart__price">
                            <!-- Đăng Nhập / Thông Tin Người Dùng -->
                            <li class="nav-item" id="loginButton">
                                <a class="nav-link" href="/login">
                                    <i class="fas fa-user-circle"></i>
                                </a>
                            </li>
                            <li class="nav-item dropdown" id="userDropdown" style="display: none;">
                                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown">
                                    <i class="fas fa-user"></i>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="/" id="userNameLink"></a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item" href="#">Profile</a>
                                    <a class="dropdown-item" href="">Giỏ hàng</a>
                                    <div class="dropdown-divider"></div>
                                    <button class="dropdown-item" onclick="signoutUser()">Đăng Xuất</button>
                                </div>
                            </li>
                        </div>
                    </ul>
                </div>

            </div>
        </div>
    </div>
</header>
<!-- Header Section End -->
<div th:insert="~{::${content}}">
    <!-- NỘI DUNG TRANG CON -->
</div>
<!-- Footer Section Begin -->
<footer class="footer spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-6 col-sm-6">
                <div class="footer__about">
                    <div class="footer__about__logo">
                        <a href="/"><img src="" alt=""></a>
                    </div>
                    <ul>
                        <li>Address: 60-49 Road 11378 New York</li>
                        <li>Phone: +65 11.188.888</li>
                        <li>Email: hello@colorlib.com</li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 col-sm-6 offset-lg-1">
                <div class="footer__widget">
                    <h6>Useful Links</h6>
                    <ul>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">About Our Shop</a></li>
                        <li><a href="#">Secure Shopping</a></li>
                        <li><a href="#">Delivery infomation</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Our Sitemap</a></li>
                    </ul>
                    <ul>
                        <li><a href="#">Who We Are</a></li>
                        <li><a href="#">Our Services</a></li>
                        <li><a href="#">Projects</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Innovation</a></li>
                        <li><a href="#">Testimonials</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-4 col-md-12">
                <div class="footer__widget">
                    <h6>Join Our Newsletter Now</h6>
                    <p>Get E-mail updates about our latest shop and special offers.</p>
                    <form action="#">
                        <input type="text" placeholder="Enter your mail">
                        <button type="submit" class="site-btn">Subscribe</button>
                    </form>
                    <div class="footer__widget__social">
                        <a href="#"><i class="fas fa-facebook"></i></a>
                        <a href="#"><i class="fas fa-instagram"></i></a>
                        <a href="#"><i class="fas fa-twitter"></i></a>
                        <a href="#"><i class="fas fa-pinterest"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="footer__copyright">
                    <div class="footer__copyright__text"><p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | Seafood Shop<i class="fas fa-heart" aria-hidden="true"></i> by <a target="_blank">ThaiVu</a>
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p></div>
                    <div class="footer__copyright__payment"><img src="/img/payment-item.png" alt=""></div>
                </div>
            </div>
        </div>
    </div>

<!-- Footer Section End -->

<!-- Js Plugins -->
<script th:src="@{/js/jquery-3.7.0.min.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>
<script th:src="@{/js/jquery.nice-select.min.js}"></script>
<script th:src="@{/js/jquery-ui.min.js}"></script>
<script th:src="@{/js/jquery.slicknav.js}"></script>
<script th:src="@{/js/mixitup.min.js}"></script>
<script th:src="@{/js/owl.carousel.min.js}"></script>
<script th:src="@{/js/main.js}"></script>
    <script th:src="@{/vendor/jquery/jquery.min.js}"></script>
    <script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
    <!-- Core plugin JavaScript-->
    <script th:src="@{/vendor/jquery/jquery.easing.min.js}"></script>
    <!-- Custom scripts for all pages-->
    <script th:src="@{/js/sb-admin-2.min.js}"></script>
    <script th:src="@{/js/admin-js.js/}"></script>
    <script>
        // Kiểm tra trạng thái đăng nhập khi trang được tải
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();

        });

        // Hàm kiểm tra trạng thái đăng nhập
        // Hàm kiểm tra trạng thái đăng nhập
        function checkLoginStatus() {
            fetch('/api/auth/check-login')
                .then(response => response.json())
                .then(data => {
                    if (data.authenticated) {
                        document.getElementById('loginButton').style.display = 'none';
                        document.getElementById('userDropdown').style.display = 'block';
                        // Lấy thông tin người dùng và hiển thị tên người dùng
                        // Đặt nội dung của thẻ a có id là "userNameLink" thành tên người dùng
                        const userNameLink = document.getElementById('userNameLink');
                        if (userNameLink) {
                            userNameLink.innerText = data.fullname;
                        }
                    } else {
                        // Chưa đăng nhập, ẩn dropdown và hiện nút đăng nhập
                        document.getElementById('loginButton').style.display = 'block';
                        document.getElementById('userDropdown').style.display = 'none';
                    }
                });
        }


        // Hàm đăng xuất
        function signoutUser() {
            fetch('/api/auth/logout', {
                method: 'POST',
            })
                .then(() => {
                    window.location.reload();
                })
                .catch(error => {
                    console.error('Đăng xuất lỗi:', error);
                    alert('Đăng xuất thất bại. Vui lòng thử lại.');
                });
        }

    </script>
    <script>
        function addToCart(seafoodId, seafoodName, price, image, quantity, categoryName) {
            // Tạo đối tượng FormData để chứa thông tin sản phẩm
            const formData = new FormData();
            formData.append("seafoodId", seafoodId);
            formData.append("seafoodName", seafoodName);
            formData.append("price", price);
            formData.append("image", image);
            formData.append("quantity", quantity);
            formData.append("categoryName", categoryName);

            // Thực hiện Ajax request sử dụng jQuery
            $.ajax({
                type: "POST",
                url: "/cart/add-to-cart",
                data: formData,
                processData: false,
                contentType: false,
                success: function(response) {
                    // Xử lý phản hồi từ máy chủ nếu cần
                    console.log("Sản phẩm đã được thêm vào giỏ hàng.");
                    updateCartItemCount();

                },
                error: function(error) {
                    console.error("Lỗi khi thêm sản phẩm vào giỏ hàng:", error);
                }
            });
        }


        // Hàm để cập nhật cartItemCount
        function updateCartItemCount() {
            const cartItemCountElement = document.getElementById("cartItemCount");

            fetch('/cartItemCount')
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    }
                    throw new Error('Network response was not ok.');
                })
                .then(quantity => {
                    cartItemCountElement.textContent = quantity;
                })
                .catch(error => {
                    console.error('There has been a problem with your fetch operation:', error);
                });
        }

        document.addEventListener("DOMContentLoaded", function() {
            // Gọi hàm cập nhật cartItemCount ban đầu
            updateCartItemCount();
        });

        function formatNumberWithCommas(number) {
            return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }
        document.querySelectorAll(".price-value").forEach(function(element) {
            var price = parseFloat(element.innerText);
            if (!isNaN(price)) {
                element.innerText = formatNumberWithCommas(price);
            }
        });


    </script>
</footer>
</body>
</html>